
# Inote, Node.js on Mobile

## Build & setup

This repository contains several samples that demonstrate "Node.js on Mobile" integration. Below are concise, practical steps and the minimal tools/versions used when the samples were created.

Prerequisites (recommended versions):
- Java JDK 8 (1.8) — many older Android build toolchains expect Java 8.
- Android Studio (use the bundled Gradle and SDK manager) — any modern release that can install Build Tools 25.0.3.
- Android SDK Platform Tools & SDK Build-Tools 25.0.3 (the sample refers to build tools 25.0.3).
- CMake (install from the Android SDK Manager) — used to build the native bridge (the sample expects CMake available).
- Gradle: use the included Gradle wrapper (do not require a system Gradle install).
- Node.js and npm (latest LTS recommended) — only required to run `npm install` inside the node project folder to vendor modules into the APK (the runtime uses the embedded libnode binary).

Key files and paths
- Location of the node app entry point (main.js) used by the "native-gradle-node-folder" sample:
	- `android/native-gradle-node-folder/app/src/main/assets/nodejs-project/main.js`
- Where to run npm to add node modules that are packaged into the APK:
	- `android/native-gradle-node-folder/app/src/main/assets/nodejs-project/` (run `npm install` here)
- Where the native libnode binaries should be placed (after downloading `nodejs-mobile` release):
	- `android/native-gradle-node-folder/app/libnode/bin/<architecture>/libnode.so`
		e.g. `android/native-gradle-node-folder/app/libnode/bin/arm64-v8a/libnode.so`
- APK build outputs (generated by Gradle):
	- `android/native-gradle-node-folder/app/build/outputs/apk/`
	- (If you build the `native-gradle` sample instead, the pattern is similar: `android/native-gradle/app/build/outputs/apk/`)

Quick build steps (minimal)
1. Clone the repository.
2. Create the node project and install npm deps (example):

```bash
# from the repository root
cd android/native-gradle-node-folder/app/src/main/assets/nodejs-project
npm install
```

3. Download the "Node.js on Mobile" shared library zip (the sample used `nodejs-mobile-v0.1.6`):
	 - https://github.com/janeasystems/nodejs-mobile/releases/download/nodejs-mobile-v0.1.6/nodejs-mobile-v0.1.6-android.zip
4. Copy the `bin/` folder from the downloaded zip to the sample's `app/libnode` folder so the binaries are available to the app at runtime. After copying you should have:

```text
android/native-gradle-node-folder/app/libnode/bin/arm64-v8a/libnode.so
android/native-gradle-node-folder/app/libnode/bin/armeabi-v7a/libnode.so
android/native-gradle-node-folder/app/libnode/bin/x86/libnode.so
android/native-gradle-node-folder/app/libnode/bin/x86_64/libnode.so
```

5. Open the Android project in Android Studio. You can import the Gradle project at `android/native-gradle-node-folder/` (or `android/native-gradle/` for the alternate sample). Android Studio will prompt to install missing SDK components (for example: Build Tools 25.0.3 or CMake).
6. Build & Run the app on a device. The generated APK(s) will be in `app/build/outputs/apk/` under the sample folder you built.

## How to Run

1.  Navigate to the Node.js project directory:

    ```bash
    cd android/native-gradle-node-folder/app/src/main/assets/nodejs-project
    ```

2.  Run the Node.js server:

    ```bash
    node min.js
    ```

## How to Build

1.  Navigate to the Android project directory:

    ```bash
    cd android/native-gradle-node-folder/
    ```

2.  Run the Gradle build command:

    ```bash
    ./gradlew clean assembleDebug
    ```

Notes & troubleshooting
- The sample copies the `nodejs-project` folder from assets to the application's FilesDir at runtime and starts the runtime with the path `.../nodejs-project/main.js`. That is why `main.js` must live in `app/src/main/assets/nodejs-project/main.js` before building the APK.
- If Gradle/Android Studio prompts for SDK build-tools or CMake, install the versions it requests (the sample historically expects Build Tools 25.0.3).
- Use the Gradle wrapper that ships with the samples to avoid Gradle version mismatches.


